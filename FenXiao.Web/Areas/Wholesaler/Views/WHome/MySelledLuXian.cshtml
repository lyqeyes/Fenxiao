@model PagedList<Product>
@{
    Layout = "~/Areas/Wholesaler/Views/Shared/_Layout.cshtml";
}
@section styles{
    <link href="~/assets/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
    <style type="text/css">
        #SellingTable_filter {
            margin-right: 100px;
        }

        #SellingTable_length {
            margin-left: 50px;
        }

        .pagination .prev a {
            height: 22px;
        }

        .pagination .next a {
            height: 22px;
        }
    </style>
}
<div class="h60"></div>
<div class="part">
    <div class="search_total">
        <ul id="SearchLink">
            <li><a href="/Wholesaler/WHome/MyLuXian">正在出售的路线</a></li>
            <li class="cut_line"></li>
            <li class="active"><a href="/Wholesaler/WHome/MySelledLuXian">已截止线路</a></li>
            <li class="cut_line"></li>
            <li><a href="/Wholesaler/WHome/MyAllLuxian">全部线路</a></li>
        </ul>
        <div class="details_part">
            <div class="top_line">
                <p>
                    <input type="text" placeholder="输入您的搜索条件">
                    <button>订单搜索</button>
                    <a class="show_details" onclick="ShowSearchDetails(this);">更多搜索条件<small>∨</small></a>
                </p>
            </div>
            <div class="second_line" id="SecondLink_Details">
                <p>
                    <span>
                        发团时间：
                        <input value="" type="text" name="sdate-start" id="datepicker1" readonly> 至　
                        <input value="" type="text" name="sdate-finish" id="datepicker2" readonly>
                    </span>
                    <span class="second_line_ct">
                        创建时间：
                        <input value="" type="text" name="cdate-start" id="datepicker3" readonly> 至　
                        <input value="" type="text" name="cdate-finish" id="datepicker4" readonly>
                    </span>
                </p>
                <p>
                    线路编号：<input type="text" id="luxianid">
                    <span class="second_line_rn">
                        热度：
                        <select name="reset_num" id="restnumid">
                            <option value="0" selected="selected">全部</option>
                            <option value="1">最热</option>
                            <option value="2">正常</option>
                        </select>
                    </span>
                    <span class="serach_btn">
                        <button onclick="serach(this)">搜索线路</button>
                    </span>
                </p>
            </div>
        </div>
    </div>
    <!--路线管理板块-->
    <div class="line_manage">
        <div class="line_manage_infor" id="ManageInfor">
            <div class="h30"></div>
            <!--正在出售-->
            <table class="table" id="SellingTable">
                <thead>
                    <tr>
                        <th>#序号</th>
                        <th>线路名称</th>
                        <th>发团日期</th>
                        <th>创建日期</th>
                        <th>同行价格(成人|儿童)</th>
                        <th>剩余量|总数量</th>
                        <th>快捷操作</th>
                    </tr>
                </thead>
                <tbody class="" id="luxian">
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.Id</td>
                            <td>
                                <a href="/Wholesaler/WHome/LuXianmanagement?ProductId=@item.Id">
                                    <b>@item.Name</b>
                                </a>
                            </td>
                            <td>@item.SendGroupTime.ToShortDateString()</td>
                            <td>@item.CreateTime.ToShortDateString()</td>
                            <td>@item.ChengRenPrice|@item.ErTongPrice</td>
                            <td>@item.RemainCount|@item.Count</td>
                            <td>
                                <span class="company_btn moreaction_btn" onclick="javascripts:ClickMoreAction(this);">快捷操作<i class="i-more"></i> </span>
                                <div class="table_moreaction" id="TableMoreAction">
                                    <img src="/images/top-arrow.png">
                                    <ul>
                                        <li><a href="/Wholesaler/WHome/EditLuXian/@item.Id">编辑线路</a> </li>
                                        <li><a href="/Wholesaler/WHome/MyLuXianDetail/@item.Id">路线详情</a> </li>
                                        <li><a href="javascript:;" onclick="javascripts:CloseMoreAction(this);">关闭</a></li>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                    }
                    <div style="text-align:center; margin-left:-2em;">
                        @Html.Pager(Model, new PagerOptions
                 {
                     HorizontalAlign = "center",
                     ShowFirstLast = false,
                     CssClass = "pagination pagination-sm",
                     NavigationPagerItemWrapperFormatString = "<li>{0}</li>",
                     ContainerTagName = "ul",
                     PageIndexParameterName = "id",
                     ShowPageIndexBox = false,
                     PrevPageText = "<<",
                     NumericPagerItemCount = 3,
                     Id = "pages",
                     NextPageText = ">>",
                     CurrentPagerItemWrapperFormatString = "<li class=\"active\"> <a>{0}</a> </li>",
                     NumericPagerItemWrapperFormatString = "<li> {0}</li>",
                 }, new { style = "margin-top:2em;margin-bottom:2em" })
                    </div>
                </tbody>
            </table>
        </div>
    </div>
</div>
@section scripts{
    <script src="~/assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <script type="text/javascript" src="/js/saler.js"></script>
    <script type="text/javascript">
    $(function () {
        $("#datepicker1").datepicker({
            changeMonth: true,  //月份下拉列表
            changeYear: true,  //月份下拉列表
            //showOn: "both",    //点击图片和输入框都弹出面板
            showButtonPanel: true, //显示面板底部按钮
            closeTextType: "关闭", //关闭按钮文字
            currentText: "今天",   //返回今天按钮文字
            dateFormat: "yy-mm-dd",
            dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],
            monthNames: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月'],
            monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月']
        });
        $("#datepicker2").datepicker({
            changeMonth: true,  //月份下拉列表
            changeYear: true,  //月份下拉列表
            //showOn: "both",    //点击图片和输入框都弹出面板
            showButtonPanel: true, //显示面板底部按钮
            closeTextType: "关闭", //关闭按钮文字
            currentText: "今天",   //返回今天按钮文字
            dateFormat: "yy-mm-dd",
            dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],
            monthNames: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月'],
            monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月']
        });
        $("#datepicker3").datepicker({
            changeMonth: true,  //月份下拉列表
            changeYear: true,  //月份下拉列表
            //showOn: "both",    //点击图片和输入框都弹出面板
            showButtonPanel: true, //显示面板底部按钮
            closeTextType: "关闭", //关闭按钮文字
            currentText: "今天",   //返回今天按钮文字
            dateFormat: "yy-mm-dd",
            dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],
            monthNames: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月'],
            monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月']
        });
        $("#datepicker4").datepicker({
            changeMonth: true,  //月份下拉列表
            changeYear: true,  //月份下拉列表
            //showOn: "both",    //点击图片和输入框都弹出面板
            showButtonPanel: true, //显示面板底部按钮
            closeTextType: "关闭", //关闭按钮文字
            currentText: "今天",   //返回今天按钮文字
            dateFormat: "yy-mm-dd",
            dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],
            monthNames: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月'],
            monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月',
            '七月', '八月', '九月', '十月', '十一月', '十二月']
        });
    });
    </script>

    <script type="text/javascript">
        function serach(obj) {
            if ($(obj).hasClass('stop')) {
                return false;
            }
            $.ajax({
                url: "/Wholesaler/WHome/SelledLuXian",
                type: "POST",
                data: {
                    sst: $("#datepicker1").val(),
                    set: $("#datepicker2").val(),
                    cst: $("#datepicker3").val(),
                    cet: $("#datepicker4").val(),
                    luxianid: $("#luxianid").val(),
                    restnum: $("#restnumid").val()
                },
                beforeSend: function (XMLHttpRequest) {
                    $(obj).html("搜索中...");
                    $(obj).addClass('stop');
                },
                success: function (data, textStatus) {
                    $("#luxian").html(data);
                },
                complete: function (XMLHttpRequest, textStatus) {
                    $(obj).html("搜索线路");
                    $(obj).removeClass('stop');
                },
                error: function () {
                    alert("好像出错了，请刷新页面重试");
                }
            });
        }

        function serachluxianid(btn) {
            $(btn).html("正在搜索");
        }
        function cancleLuxian(_id) {
            $.ajax(
                {
                    url: "/Wholesaler/WHome/CancelLuXian",
                    type: "POST",
                    data:
                        {
                            id: _id,

                        },
                    beforeSend: function (XMLHttpRequest) {
                    },
                    success: function (data, textStatus) {
                        var res = $.parseJSON(data);
                        if (res.Ok == "1") {
                            location.reload()
                        } else {
                            alert(res.Msg);
                        }
                    },
                    complete: function (XMLHttpRequest, textStatus) {
                    },
                    error: function () {
                        alert("好像出错了，请刷新页面重试");
                    }
                })
        }

        function recoverLuXian(_id)
        {
            $.ajax(
               {
                   url: "/Wholesaler/WHome/RecoverLuXian",
                   type: "POST",
                   data:
                       {
                           id: _id,

                       },
                   beforeSend: function (XMLHttpRequest) {
                   },
                   success: function (data, textStatus) {
                       var res = $.parseJSON(data);
                       if (res.Ok == "1") {
                           location.reload()
                       } else {
                           alert(res.Msg);
                       }
                   },
                   complete: function (XMLHttpRequest, textStatus) {
                   },
                   error: function () {
                       alert("好像出错了，请刷新页面重试");
                   }
               })
        }
    </script>
    <script type="text/javascript">
        $("#Menu").children("li").eq(0).removeClass("active");
        $("#Menu").children("li").eq(1).removeClass("active");
        $("#Menu").children("li").eq(2).removeClass("active");
        $("#Menu").children("li").eq(3).removeClass("active");
        $("#Menu").children("li").eq(4).removeClass("active");
        $("#Menu").children("li").eq(5).removeClass("active");
        $("#Menu").children("li").eq(1).addClass("active");
    </script>
}